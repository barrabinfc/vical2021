---
import { Markdown } from 'astro/components';
import BaseLayout from '../layouts/base.astro';

import {listProjects} from './projects';
import {listGarden} from './garden';
import Card from '../components/Card/Card.tsx';

let content = {
  title: 'Hello World',
  description: 'Index description',
  schema: 'article'
};
let projects: MarkdownPage[] = await listProjects();
let garden: GardenPage[] = await listGarden();
---

<BaseLayout {content}>
  <div id="content">
    <section class="home" aria-labelledby="welcome">
      <div class="home-grid">
        <div class="item highlight pad4">
          <div role="heading" aria-level="1" id="welcome" class="caption">
            Hi üëã<br/>
            I'm <strong>Vitor</strong><br/>
            I write software for the web
          </div>
        </div>
        <div class="item highlight2 pad4">
          <div class="caption">
            Hi üôè <br/>
            I'm <strong>Vitor</strong><br/>
            I write software for the web
          </div>
        </div>
        <div class="item decoration">
          <img alt="nada" src="/pictures/Dieffenbachia robusta.png" />
        </div>
      </div>
    </section>

    <section class="pad4">
      <h2>Projects</h2>
      <div class="project-grid">
        {projects.slice(0, 3).map((project) => (
          <Card tag="li"
            href={project.path}
            avatar={project.thumbnail}
            content={project.content}
            className={`item ${project.slug}`}
            />
        ))}
      </div>
      <div class="pad4"/>
    </section>

    <section class="pad4">
      <h2>Garden</h2>
      <div class="garden-grid">
        {garden.map((garden) => (
          <Card tag="li"
            href={garden.path}
            avatar={garden.thumbnail}
            content={garden.content}
            className={`item ${garden.slug}`}
            />
        ))}
      </div>
      <div class="pad4"/>
    </section>
  </div>
</BaseLayout>

<style lang="scss" scoped>
@use "sass:math";
@use "src/styles/breakpoints" as bp;
@use "src/styles/grids" as grids;

#content {
  position: relative;
}

$fold: 100vh;
.home {
  width: 100%;
  height: $fold;
}

.home-grid {
  height: 100%;

  $gap: 0px;
  @include grids.grid(6, $gap);
  grid-template-rows: repeat(4, math.div( $fold, 4 ));

  :global(.highlight){
    grid-column: 4 / span 4;
    grid-row: 1 / span 3;

    display: flex;
    flex-direction: column;
    justify-content: flex-end;

    // background-color: var(--brand);
    // color: var(--text1-invert);

    > :global(.caption) {
      font-family: var(--title-family);
      font-size: calc( var(--h1) * 1.1 );
      font-weight: 200;
      margin-bottom: 1em;
      // font-variation-settings: "wght" 200;
    }
  }
  :global(.highlight2) {
    grid-column: 4 / span 4;
    grid-row: 4;
  }
  :global(.decoration) {
    grid-column: 1 / span 3;
    grid-row: 1/ span 4;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: flex-end;

    > img {
      height: 100%;
    }
  }
}

.project-grid {
  $columns: 3;
  $gap: 32px;
  $itemWidth: calc(#{math.div(100%, $columns)} - #{$gap});

  @include grids.flexGrid($columns, $gap);


  @include bp.breakpoint(medium, min) {
    :global(.item:nth-child(1n)) {
      flex: 0 0 33%;
    }
    :global(.item:nth-child(2n)) {
      flex: 0 0  calc(2 * #{$itemWidth});
    }
    :global(.item:nth-child(3n)) {
      flex: 0 0  calc(3 * #{$itemWidth});
    }
  }

}
</style>
